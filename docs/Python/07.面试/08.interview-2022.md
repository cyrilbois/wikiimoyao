---
title:  2022 面试记录
date: 2022-03-22 13:56:51
permalink: /interview-2022/
categories:
  - 🐍Python
  - 面试
tags:
  - 面试
---

## 博智数源项目梳理

### 简述遇到的问题以及如何解决

- dt 表（订单表）太大，数据查询太慢

按照月份进行水平分表，为什么呢？因为我们数据分析查询的时候是按照月份来进行查询的，对业务来说更加方便，直接命名为`dt_xx_202112`

- 数据库连接出现`Lost connection to MySQL server during query`

  应该保持每次操作时都重新初始化连接，而不是让连接一直保持住，否则，连接等待超时之后报错。

  ref：[Python 长期连接数据库的最不佳实践：Lost connection to MySQL server during query – 土豆不好吃](https://dmesg.app/python-longpoll-db.html/amp)

- 接口设计不合理

  在地图渲染零售户画像时，查询商户信息数据直接在渲染地图时查询返回，导致`Serializer`时耗时过大，只返回商户编码、经纬度信息即可，当点击商户点时再返回单个商户的信息。

- 解耦

商圈信息获取和存入写在一个类中，拆分之后持久化单独存在

### 服务器配置
- 云服务器 ECS
```plain
8核 64 GiB  -- 之前是32G，但是增加Java应用之后内存90%+，所以升级
CentOS  7.6 64位
```
- 云数据库 RDS
```plain
-- MySQL 5.7

2核心8G内存  （60%）
最大连接数 6000 最大IOPS 10000 存储空间 300G 
```

```sql
-- 事务级别
select @@global.tx_isolation;

REPEATABLE-READ
```

```plain
-- MySQL 8.0

4核心8G内存  （60%）
最大连接数 6000 最大IOPS 20000 存储空间 700G 
```
```sql
select @@transaction_isolation;

-- READ-COMMITTED
```
## 鲸鲨项目梳理

### 项目

[一种基于 DRBD 实现的 ALUA 解决方案 | 别院牧志](https://masantu.com/blog/2020-07-22/alua-with-drbd/)

### 单例模式

- 日志系统（数据库连接）

  资源共享的情况下，避免由于资源操作时导致的性能或损耗等。如日志文件，应用配置

1. [python Logger 模块单例模式 - ChnMig - 博客园](https://www.cnblogs.com/chnmig/p/12106622.html)
2. [python logging 单例模式范例_全栈博客的技术博客_51CTO 博客](https://blog.51cto.com/reboot001/1732450)

## 其他

- 保存 emoji 需要使用`utf8emb4`

  ref：[解决博客 idealyard 支持 emoji 显示问题 | 别院牧志](https://masantu.com/blog/2020-05-15/idealyard-loves-emoji/)

- 后端数据校验： json-schema、marshmallow
